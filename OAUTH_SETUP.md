# OAuth ì„¤ì • ê°€ì´ë“œ

ì´ ë¬¸ì„œëŠ” Google ë° Kakao OAuth í´ë¼ì´ì–¸íŠ¸ IDì™€ Secretì„ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

## ğŸ“‹ ëª©ì°¨

1. [Google OAuth ì„¤ì •](#google-oauth-ì„¤ì •)
2. [Kakao OAuth ì„¤ì •](#kakao-oauth-ì„¤ì •)
3. [í™˜ê²½ ë³€ìˆ˜ ì„¤ì •](#í™˜ê²½-ë³€ìˆ˜-ì„¤ì •)

---

## ğŸ”µ Google OAuth ì„¤ì •

### 1ë‹¨ê³„: Google Cloud Console ì ‘ì†

1. [Google Cloud Console](https://console.cloud.google.com/)ì— ì ‘ì†í•©ë‹ˆë‹¤.
2. Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.
3. ìƒë‹¨ì˜ í”„ë¡œì íŠ¸ ì„ íƒ ë“œë¡­ë‹¤ìš´ì„ í´ë¦­í•©ë‹ˆë‹¤.

### 2ë‹¨ê³„: ìƒˆ í”„ë¡œì íŠ¸ ìƒì„± (ì„ íƒì‚¬í•­)

ê¸°ì¡´ í”„ë¡œì íŠ¸ê°€ ì—†ë‹¤ë©´ ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

1. **í”„ë¡œì íŠ¸ ì„ íƒ** ë“œë¡­ë‹¤ìš´ì—ì„œ **ìƒˆ í”„ë¡œì íŠ¸** í´ë¦­
2. í”„ë¡œì íŠ¸ ì´ë¦„ ì…ë ¥ (ì˜ˆ: `korean-clinic-advisor`)
3. **ë§Œë“¤ê¸°** í´ë¦­
4. í”„ë¡œì íŠ¸ ìƒì„± ì™„ë£Œê¹Œì§€ ëŒ€ê¸° (ëª‡ ì´ˆ ì†Œìš”)

### 3ë‹¨ê³„: OAuth ë™ì˜ í™”ë©´ ì„¤ì •

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **API ë° ì„œë¹„ìŠ¤** > **OAuth ë™ì˜ í™”ë©´** í´ë¦­
2. **ì™¸ë¶€** ì‚¬ìš©ì ìœ í˜• ì„ íƒ í›„ **ë§Œë“¤ê¸°** í´ë¦­
3. **ì•± ì •ë³´** ì…ë ¥:
   - **ì•± ì´ë¦„**: `Korean Clinic Advisor` (ë˜ëŠ” ì›í•˜ëŠ” ì´ë¦„)
   - **ì‚¬ìš©ì ì§€ì› ì´ë©”ì¼**: ë³¸ì¸ì˜ ì´ë©”ì¼ ì£¼ì†Œ
   - **ì•± ë¡œê³ **: (ì„ íƒì‚¬í•­) ë¡œê³  ì´ë¯¸ì§€ ì—…ë¡œë“œ
   - **ì•± ë„ë©”ì¸**: (ì„ íƒì‚¬í•­) `localhost:3000`
   - **ê°œë°œì ì—°ë½ì²˜ ì •ë³´**: ë³¸ì¸ì˜ ì´ë©”ì¼ ì£¼ì†Œ
4. **ì €ì¥ í›„ ê³„ì†** í´ë¦­
5. **ë²”ìœ„** ë‹¨ê³„ì—ì„œ **ì €ì¥ í›„ ê³„ì†** í´ë¦­ (ê¸°ë³¸ ë²”ìœ„ ì‚¬ìš©)
6. **í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì** ë‹¨ê³„ì—ì„œ (ì„ íƒì‚¬í•­) í…ŒìŠ¤íŠ¸ ì´ë©”ì¼ ì¶”ê°€ í›„ **ì €ì¥ í›„ ê³„ì†** í´ë¦­
7. **ìš”ì•½** ë‹¨ê³„ì—ì„œ ì •ë³´ í™•ì¸ í›„ **ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°** í´ë¦­

### 4ë‹¨ê³„: OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID ìƒì„±

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **API ë° ì„œë¹„ìŠ¤** > **ì‚¬ìš©ì ì¸ì¦ ì •ë³´** í´ë¦­
2. ìƒë‹¨ì˜ **+ ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ë§Œë“¤ê¸°** í´ë¦­
3. **OAuth í´ë¼ì´ì–¸íŠ¸ ID** ì„ íƒ
4. **ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ í˜•**: **ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜** ì„ íƒ
5. **ì´ë¦„**: `Korean Clinic Advisor Web Client` (ë˜ëŠ” ì›í•˜ëŠ” ì´ë¦„)
6. **ìŠ¹ì¸ëœ ë¦¬ë””ë ‰ì…˜ URI** ì¶”ê°€:
   ```
   http://localhost:3000/api/auth/callback/google
   ```
   
   í”„ë¡œë•ì…˜ í™˜ê²½ì˜ ê²½ìš° ì¶”ê°€ë¡œ:
   ```
   https://yourdomain.com/api/auth/callback/google
   ```
7. **ë§Œë“¤ê¸°** í´ë¦­
8. **í´ë¼ì´ì–¸íŠ¸ ID**ì™€ **í´ë¼ì´ì–¸íŠ¸ ë³´ì•ˆ ë¹„ë°€ë²ˆí˜¸**ê°€ í‘œì‹œë©ë‹ˆë‹¤
   - âš ï¸ **ì¤‘ìš”**: ì´ ì •ë³´ëŠ” í•œ ë²ˆë§Œ í‘œì‹œë˜ë¯€ë¡œ ë³µì‚¬í•´ì„œ ì•ˆì „í•œ ê³³ì— ë³´ê´€í•˜ì„¸ìš”!

### 5ë‹¨ê³„: OAuth API í™œì„±í™”

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **API ë° ì„œë¹„ìŠ¤** > **ë¼ì´ë¸ŒëŸ¬ë¦¬** í´ë¦­
2. ê²€ìƒ‰ì°½ì— "Google+ API" ë˜ëŠ” "People API" ê²€ìƒ‰
3. **Google+ API** ë˜ëŠ” **Google People API** ì„ íƒ
4. **ì‚¬ìš© ì„¤ì •** í´ë¦­

### 6ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ì— ì¶”ê°€

ìƒì„±ëœ í´ë¼ì´ì–¸íŠ¸ IDì™€ Secretì„ `.env.local` íŒŒì¼ì— ì¶”ê°€í•©ë‹ˆë‹¤:

```bash
GOOGLE_CLIENT_ID="your-google-client-id-here"
GOOGLE_CLIENT_SECRET="your-google-client-secret-here"
```

---

## ğŸŸ¡ Kakao OAuth ì„¤ì •

### 1ë‹¨ê³„: Kakao Developers ì ‘ì†

1. [Kakao Developers](https://developers.kakao.com/)ì— ì ‘ì†í•©ë‹ˆë‹¤.
2. Kakao ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.

### 2ë‹¨ê³„: ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡

1. ìƒë‹¨ ë©”ë‰´ì—ì„œ **ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜** í´ë¦­
2. **ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€í•˜ê¸°** í´ë¦­
3. ì• í”Œë¦¬ì¼€ì´ì…˜ ì •ë³´ ì…ë ¥:
   - **ì•± ì´ë¦„**: `Korean Clinic Advisor` (ë˜ëŠ” ì›í•˜ëŠ” ì´ë¦„)
   - **ì‚¬ì—…ìëª…**: (ê°œì¸ ê°œë°œìì˜ ê²½ìš° ë³¸ì¸ ì´ë¦„)
4. **ì €ì¥** í´ë¦­

### 3ë‹¨ê³„: í”Œë«í¼ ì„¤ì •

1. ìƒì„±ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í´ë¦­í•˜ì—¬ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™
2. ì™¼ìª½ ë©”ë‰´ì—ì„œ **í”Œë«í¼** í´ë¦­
3. **Web í”Œë«í¼ ë“±ë¡** í´ë¦­
4. **ì‚¬ì´íŠ¸ ë„ë©”ì¸** ì…ë ¥:
   ```
   http://localhost:3000
   ```
5. **ì €ì¥** í´ë¦­

### 4ë‹¨ê³„: Redirect URI ì„¤ì •

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **ì œí’ˆ ì„¤ì •** > **ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸** í´ë¦­
2. **ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í™œì„±í™”** í† ê¸€ì„ **ON**ìœ¼ë¡œ ì„¤ì •
3. **Redirect URI** ì„¹ì…˜ì—ì„œ **URI ì¶”ê°€** í´ë¦­
4. ë‹¤ìŒ URI ì¶”ê°€:
   ```
   http://localhost:3000/api/auth/callback/kakao
   ```
   
   í”„ë¡œë•ì…˜ í™˜ê²½ì˜ ê²½ìš° ì¶”ê°€ë¡œ:
   ```
   https://yourdomain.com/api/auth/callback/kakao
   ```
5. **ì €ì¥** í´ë¦­

### 5ë‹¨ê³„: ë™ì˜ í•­ëª© ì„¤ì •

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **ì œí’ˆ ì„¤ì •** > **ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸** > **ë™ì˜í•­ëª©** í´ë¦­
2. í•„ìš”í•œ ë™ì˜ í•­ëª© í™œì„±í™”:
   - **ë‹‰ë„¤ì„** (í•„ìˆ˜)
   - **í”„ë¡œí•„ ì‚¬ì§„** (ì„ íƒ)
   - **ì¹´ì¹´ì˜¤ê³„ì •(ì´ë©”ì¼)** (ì„ íƒ)
3. ê° í•­ëª©ì˜ **í•„ìˆ˜ ë™ì˜** ë˜ëŠ” **ì„ íƒ ë™ì˜** ì„¤ì •
4. **ì €ì¥** í´ë¦­

### 6ë‹¨ê³„: REST API í‚¤ í™•ì¸

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **ì•± ì„¤ì •** > **ì•± í‚¤** í´ë¦­
2. **REST API í‚¤** í™•ì¸ (ì´ê²ƒì´ Client IDì…ë‹ˆë‹¤)
3. **REST API í‚¤** ì˜†ì˜ **ë³´ê¸°** í´ë¦­í•˜ì—¬ í‚¤ í™•ì¸

### 7ë‹¨ê³„: Client Secret ìƒì„±

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **ì œí’ˆ ì„¤ì •** > **ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸** > **ë³´ì•ˆ** í´ë¦­
2. **Client Secret ì½”ë“œ** ì„¹ì…˜ì—ì„œ **ì½”ë“œ ë°œê¸‰** í´ë¦­
3. ë³´ì•ˆ í™•ì¸ í›„ **Client Secret** ìƒì„±
   - âš ï¸ **ì¤‘ìš”**: ì´ ì •ë³´ëŠ” í•œ ë²ˆë§Œ í‘œì‹œë˜ë¯€ë¡œ ë³µì‚¬í•´ì„œ ì•ˆì „í•œ ê³³ì— ë³´ê´€í•˜ì„¸ìš”!

### 8ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ì— ì¶”ê°€

ìƒì„±ëœ REST API í‚¤ì™€ Client Secretì„ `.env.local` íŒŒì¼ì— ì¶”ê°€í•©ë‹ˆë‹¤:

```bash
KAKAO_CLIENT_ID="your-kakao-rest-api-key-here"
KAKAO_CLIENT_SECRET="your-kakao-client-secret-here"
```

---

## âš™ï¸ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

### .env.local íŒŒì¼ ìƒì„±

í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— `.env.local` íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒ ë‚´ìš©ì„ ì¶”ê°€í•©ë‹ˆë‹¤:

```bash
# Database
DATABASE_URL="postgresql://user:password@localhost:5432/korean_clinic_advisor"

# NextAuth
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret-key-here"

# Google OAuth
GOOGLE_CLIENT_ID="your-google-client-id"
GOOGLE_CLIENT_SECRET="your-google-client-secret"

# Kakao OAuth
KAKAO_CLIENT_ID="your-kakao-client-id"
KAKAO_CLIENT_SECRET="your-kakao-client-secret"

# Google Maps API
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY="your-google-maps-api-key"
```

### NEXTAUTH_SECRET ìƒì„±

í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì‹œí¬ë¦¿ í‚¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

```bash
openssl rand -base64 32
```

ìƒì„±ëœ í‚¤ë¥¼ `NEXTAUTH_SECRET`ì— ë³µì‚¬í•©ë‹ˆë‹¤.

---

## âœ… ì„¤ì • í™•ì¸

### 1. ê°œë°œ ì„œë²„ ì‹¤í–‰

```bash
npm run dev
```

### 2. ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸

1. ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost:3000/login` ì ‘ì†
2. **Googleë¡œ ë¡œê·¸ì¸** ë˜ëŠ” **Kakaoë¡œ ë¡œê·¸ì¸** ë²„íŠ¼ í´ë¦­
3. OAuth ì¸ì¦ í™”ë©´ì´ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
4. ë¡œê·¸ì¸ ì„±ê³µ í›„ ë©”ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë˜ëŠ”ì§€ í™•ì¸

### 3. ë¬¸ì œ í•´ê²°

#### Google OAuth ì˜¤ë¥˜

- **ì˜¤ë¥˜**: `redirect_uri_mismatch`
  - **í•´ê²°**: Google Cloud Consoleì—ì„œ Redirect URIê°€ ì •í™•íˆ `http://localhost:3000/api/auth/callback/google`ë¡œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸

- **ì˜¤ë¥˜**: `access_denied`
  - **í•´ê²°**: OAuth ë™ì˜ í™”ë©´ì—ì„œ í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìë¡œ ë“±ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸ (ì•±ì´ ê²€í†  ì¤‘ì¸ ê²½ìš°)

#### Kakao OAuth ì˜¤ë¥˜

- **ì˜¤ë¥˜**: `invalid_client`
  - **í•´ê²°**: REST API í‚¤ì™€ Client Secretì´ ì •í™•íˆ ì…ë ¥ë˜ì—ˆëŠ”ì§€ í™•ì¸

- **ì˜¤ë¥˜**: `redirect_uri_mismatch`
  - **í•´ê²°**: Kakao Developersì—ì„œ Redirect URIê°€ ì •í™•íˆ `http://localhost:3000/api/auth/callback/kakao`ë¡œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Google OAuth 2.0 ë¬¸ì„œ](https://developers.google.com/identity/protocols/oauth2)
- [Kakao ë¡œê·¸ì¸ REST API ë¬¸ì„œ](https://developers.kakao.com/docs/latest/ko/kakaologin/rest-api)
- [NextAuth.js ë¬¸ì„œ](https://next-auth.js.org/)

---

## ğŸ”’ ë³´ì•ˆ ì£¼ì˜ì‚¬í•­

1. **ì ˆëŒ€ `.env.local` íŒŒì¼ì„ Gitì— ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš”!**
   - `.gitignore`ì— `.env.local`ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

2. **í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” HTTPSë¥¼ ì‚¬ìš©í•˜ì„¸ìš”**
   - OAuthëŠ” HTTPS í™˜ê²½ì—ì„œë§Œ ì•ˆì „í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤

3. **Client Secretì€ ì ˆëŒ€ ê³µê°œí•˜ì§€ ë§ˆì„¸ìš”**
   - í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œì— ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ ì£¼ì˜

4. **ì •ê¸°ì ìœ¼ë¡œ í‚¤ë¥¼ ê°±ì‹ í•˜ì„¸ìš”**
   - ë³´ì•ˆì„ ìœ„í•´ ì£¼ê¸°ì ìœ¼ë¡œ OAuth í‚¤ë¥¼ ì¬ìƒì„±í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤

